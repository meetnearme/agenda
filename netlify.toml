[build]
  # Uses SITE_CONFIG env var to determine which config to use:
  # - SITE_CONFIG=atx-agenda  → ATX Agenda site (removes template)
  # - SITE_CONFIG=marketing   → Marketing site (keeps template)
  # - (not set)               → Customer fork (removes template, keeps defaults)
  command = "pnpm build:ci"
  publish = "out"

[build.environment]
  NODE_VERSION = "20"

[functions]
  directory = "netlify/functions"

# Redirects for Decap CMS
[[redirects]]
  from = "/admin"
  to = "/admin/index.html"
  status = 200

[[redirects]]
  from = "/admin/"
  to = "/admin/index.html"
  status = 200

# Enable Netlify Identity for CMS authentication
[build.processing]
  skip_processing = false

[build.processing.html]
  pretty_urls = true

